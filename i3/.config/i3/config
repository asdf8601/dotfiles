# set modifier
set $super Mod4
set $alt Mod1
set $height 34
set $editor kitty

# Use: xrandr command to check monitor names.
# set font
font pango:CaskaydiaCove Nerd Font, FontAwesome 12

set_from_resource $darkred     color1  #000000
set_from_resource $red         color9  #000000
set_from_resource $darkgreen   color2  #000000
set_from_resource $green       color10 #000000
set_from_resource $darkyellow  color3  #000000
set_from_resource $yellow      color11 #000000
set_from_resource $darkblue    color4  #000000
set_from_resource $blue        color12 #000000
set_from_resource $darkmagenta color5  #000000
set_from_resource $magenta     color13 #000000
set_from_resource $darkcyan    color6  #000000
set_from_resource $cyan        color14 #000000
set_from_resource $darkwhite   color7  #000000
set_from_resource $white       color15 #000000
# Use custom colors for black
set $black       #282828
set $darkblack   #1d2021
set $transparent #00000000

floating_minimum_size -1 x -1
floating_maximum_size -1 x -1


#                       BORDER      BACKGROUND  TEXT        INDICATOR   CHILD_BORDER
client.focused          $black      $black      $darkwhite  $darkblack  $darkblack
client.unfocused        $black      $black      $white      $darkblack  $darkblack
client.focused_inactive $black      $black      $white      $darkblack  $darkblack
client.urgent           $darkred    $darkred    $black      $darkred    $darkred
client.background       $black

workspace_auto_back_and_forth yes
force_display_urgency_hint 0 ms
focus_on_window_activation urgent
# Use Mouse+$super to drag floating windows to their wanted position
floating_modifier $super

set $ws1   "1:  "
set $ws2   "2:  "
set $ws3   "3:  "
set $ws4   "4:  "
set $ws5   "5:  "
set $ws6   "6:  "
set $ws7   "7:  "
set $ws8   "8:  "
set $ws9   "9:  "
set $ws10 "10:  "

bindsym $super+Return exec kitty
bindsym $super+t exec xterm

# bindsym $super+Shift+Return workspace 1; focus; exec xterm
# bindsym $super+Shift+Ctrl+v exec croma

# start dmenu (a program launcher)
bindsym $super+Shift+d exec i3-dmenu-desktop --dmenu="dmenu -i -fn 'ubuntu:size=12'"
bindsym $super+Shift+t exec pkill picom && picom -b

# open rofi
bindsym $super+d exec rofi -lines 12 -padding 18 -width 60 -location 0 -show drun -sidebar-mode -columns 3 -font 'ubuntu 12'
bindsym $super+Ctrl+Shift+k exec "i3bindings | rofi -dmenu -no-config -theme-str 'listview { columns: 1; flow: vertical; }' -width 80"

# bindsym $super+c exec notify-send Moira "$(moira check)"
# bindsym $super+v exec notify-send VPN "$(nmcli con up ets)"

bindsym XF86MonBrightnessUp exec --no-startup-id light -A 1 # increase screen brightness
bindsym XF86MonBrightnessDown exec --no-startup-id light -U 1 # decrease screen brightness

# monitor settings using rofi
bindsym $super+Ctrl+Shift+m exec rofi-randr
bindsym $super+Ctrl+Shift+x exec xrandr --auto
bindsym $super+Ctrl+Shift+t exec monitor_layout.sh

# change wallpaper
bindsym $super+Ctrl+Shift+e exec --no-startup-id feh -D 3600 --randomize --bg-fill $HOME/github/mmngreco/wallpapers/*
bindsym $super+Ctrl+Shift+w exec --no-startup-id feh --randomize --bg-fill $HOME/github/mmngreco/wallpapers/*

# Screenshots
bindsym $alt+Ctrl+f exec img=$HOME/Pictures/ScreenShot_$(date +%Y-%m-%d_%H%M%S).png && maim $img && cat $img && viewnior $img
bindsym --release $alt+Ctrl+s exec img=$HOME/Pictures/ScreenShot_$(date +%Y-%m-%d_%H%M%S).png && maim -s $img && cat $img && xclip -selection clipboard -t image/png -i $img
# bindsym $alt+Shift+Ctrl+v exec "i3-nagbar -t warning -m 'Screen Recording?' -b 'Start' 'rec_screen &' -b 'Stop' 'pkill ffmpeg'"

# define lock screen
bindsym $super+Ctrl+l exec i3lock -i /home/mgreco/github/mmngreco/wallpapers/0007.png

# browsers
bindsym $super+w exec brave-browser-stable

# open file browser
bindsym $super+Shift+f exec nautilus
# bindsym $super+Shift+f workspace 4; focus; exec nautilus
bindsym $super+m fullscreen toggle
bindsym $super+y fullscreen disable; floating enable; resize set 600 450; sticky enable; move window to position 1940 54


# ============================================================================
# Focus

# kill focused window
bindsym $super+q kill
# bindsym $super+c kill

# change focus
bindsym $super+h focus left
bindsym $super+j focus down
bindsym $super+k focus up
bindsym $super+l focus right


# avoid using alt+{hjkl} as it's used in tmux
# move focused window
bindsym Ctrl+Shift+h move left
bindsym Ctrl+Shift+j move down
bindsym Ctrl+Shift+k move up
bindsym Ctrl+Shift+l move right

# ============================================================================
# splits / layout

# split in vertical orientation
bindsym $super+Shift+v split h

# split in horizontal orientation
bindsym $super+Shift+h split v

# change container layout split
bindsym Ctrl+Shift+s layout toggle split

# enter fullscreen mode for the focused container
# bindsym Ctrl+Shift+m fullscreen toggle

# toggle tiling / floating
bindsym Ctrl+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $alt+Ctrl+Shift+s focus mode_toggle


# switch to workspace
# bindsym $alt+Shift+Ctrl+h workspace next
# bindsym $alt+Shift+Ctrl+l workspace prev

# move focused container to workspace
bindsym $super+Shift+1 move container to workspace $ws1
bindsym $super+Shift+2 move container to workspace $ws2
bindsym $super+Shift+3 move container to workspace $ws3
bindsym $super+Shift+4 move container to workspace $ws4
bindsym $super+Shift+5 move container to workspace $ws5

bindsym $super+Shift+6 move container to workspace $ws6
bindsym $super+Shift+7 move container to workspace $ws7
bindsym $super+Shift+8 move container to workspace $ws8
bindsym $super+Shift+9 move container to workspace $ws9
bindsym $super+Shift+0 move container to workspace $ws10

# move workspace between screens
bindsym $super+Ctrl+greater move workspace to output right
bindsym $super+Ctrl+less move workspace to output left

# resize window (you can also use the mouse for that)
mode "resize" {
    bindsym h resize shrink width 5 px or 5 ppt
    bindsym j resize grow height 5 px or 5 ppt
    bindsym k resize shrink height 5 px or 5 ppt
    bindsym l resize grow width 5 px or 5 ppt
    bindsym Return mode "default"
}
bindsym $super+Shift+r mode "resize"


# =============================================================================
# Focus


set $monitor_secondary eDP-1
workspace $ws6 output $monitor_secondary
workspace $ws7 output $monitor_secondary
workspace $ws8 output $monitor_secondary
workspace $ws9 output $monitor_secondary
workspace $ws10 output $monitor_secondary


set $monitor_primary HDMI-1
workspace $ws1 output $monitor_primary
workspace $ws2 output $monitor_primary
workspace $ws3 output $monitor_primary
workspace $ws4 output $monitor_primary
workspace $ws5 output $monitor_primary

bindsym $super+1 workspace $ws1
bindsym $super+2 workspace $ws2
bindsym $super+3 workspace $ws3
bindsym $super+4 workspace $ws4
bindsym $super+5 workspace $ws5

bindsym $super+6 workspace $ws6
bindsym $super+7 workspace $ws7
bindsym $super+8 workspace $ws8
bindsym $super+9 workspace $ws9
bindsym $super+0 workspace $ws10

bindsym $super+Tab workspace next
bindsym $super+Shift+Tab workspace prev


bindsym $super+f fullscreen
bindsym $super+g fullscreen global

bindsym $super+z layout stacking
bindsym $super+x layout tabbed
bindsym $super+c layout toggle split

bindsym $super+Shift+space floating toggle
bindsym $super+space focus mode_toggle

bindsym $super+a focus parent
bindsym $super+Shift+a focus child


# =============================================================================
# System
#
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $super+Ctrl+Shift+r restart

# close session
bindsym $super+Shift+q exec i3-nagbar -t warning -m 'Logout ?' -b 'Yes' 'i3-msg exit', mode "default"

# power off
bindsym $super+Shift+Ctrl+q exec i3-nagbar -t warning -m 'Poweroff ?' -b 'Yes' 'exec systemctl poweroff -i', mode "default"

bindsym $super+Shift+w exec --no-startup-id $editor --class "__nmtui" -e "nmtui-connect"

# panel
bar {
#    verbose yes
    status_command i3blocks
    i3bar_command i3bar -t
    position top
    font pango:CaskaydiaCove Nerd Font, FontAwesome 12
    strip_workspace_numbers yes
    separator_symbol "■"
    bindsym button4 nop
    bindsym button5 nop
    tray_output primary
#    tray_output eDP1
    tray_padding 7
    height $height
    colors {
        statusline         $white
        background         $transparent
        separator          $transparent

#                          BORDER       BACKGROUND   TEXT
        focused_workspace  $transparent $transparent $white
        inactive_workspace $transparent $transparent $black
        active_workspace   $transparent $transparent $white
        urgent_workspace   $darkred     $darkred     $transparent
        binding_mode       $darkred     $darkred     $transparent
    }
}

# default_orientation vertical #start in opposite orientation from your monitor
for_window [class=".*"] split toggle
# toggles split at each new window
# bindsym $mod+shift+q split toggle kill #kill command resets the split
# should already exist but use if split orientation  messes up
bindsym $super+e layout toggle split


# window rules, you can find the window class using xprop
for_window [class=".*"] border pixel 0
gaps inner 8
gaps outer 30
gaps top 5
gaps bottom 30


assign [class=kitty] $ws1
assign [class=Brave-browser] $ws2
assign [class=DBeaver] $ws3
assign [class=slack|Slack] $ws4
# assign [class=Org.gnome.Nautilus|Thunar|File-roller] $ws4
assign [class=libreoffice*|Gimp*|Inkscape] $ws5
assign [class=TelegramDesktop] $ws6
assign [class=keepassxc|KeePassXC] $ws8
assign [class=Audacity|Vlc|mpv|Ghb|Xfburn] $ws8
assign [class=obs|easyeffects] $ws9

for_window [class=Viewnior|feh|File-roller|Lxappearance] floating enable
# for_window [class=Org.gnome.Nautilus|Brave-browser|firefox|TelegramDesktop|Gimp*|Inkscape|Vlc] focus
for_window [class=".*"] focus


for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_role="Preferences"] floating enable

for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable
for_window [instance="__scratchpad"] floating enable, resize set 900 px 500 px, move position center
for_window [instance="__nmtui"] floating enable


# autostart
exec --no-startup-id xrandr --output HDMI-1 --left-of eDP-1 --auto --primary
exec --no-startup-id feh --bg-fill $HOME/github/mmngreco/wallpapers/WallpaperDog-10941700.jpg
exec --no-startup-id dunst &
exec --no-startup-id xsettingsd &
exec --no-startup-id nm-applet &
exec --no-startup-id blueman-applet &
exec --no-startup-id volumeicon &
exec --no-startup-id picom -b --experimental-backends

# exec --no-startup-id slimbookbattery &
# exec --no-startup-id caffeine-indicator &
# exec --no-startup-id clipit &

exec --no-startup-id i3-msg 'exec kitty'
exec --no-startup-id i3-msg 'exec QT_SCALE_FACTOR=1.5 keepassxc'
# exec --no-startup-id i3-msg 'exec xterm'
# exec --no-startup-id i3-msg 'exec nautilus'
# exec --no-startup-id i3-msg 'exec telegram-desktop'
# exec --no-startup-id i3-msg 'exec flatpak run com.github.wwmm.easyeffects'
exec_always --no-startup-id "pgrep --exact xev || xev -root -event randr | grep --line-buffered ScreenChangeNotify | while read change; do pkill -RTMIN+4 i3blocks; done"

